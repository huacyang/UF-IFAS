var adobeDPS=function(){function J(){throw Error("Class object should never be directly constructed");}function L(a,b){this.lvl=a;this.msg=b;this.timestamp=new Date}function d(){this.enableLogging=!0;this._profileTimers={};this._logList=[]}function w(){if(!(this instanceof w))throw Error("Bridge initialized without new keyword!");var a;this.BRIDGE_PREFIX_URI="bridge://";this.bridgeBusy=!0;this.bridgeMessageQueue=[];this.messageBuffer=[];this.totalSends=this.sendTime=this.sentData=0;this.metrics=[Infinity,
-Infinity,0];this.metricsLogTimeout=null;this.location="adobeDPS._bridge";document.body!==null?(this.bridgeBusy=!1,this.out({event:{type:"BridgeInitialized",bridgeLocation:this.location}}),d.instance.info("BridgeInitialized - LOC: "+this.location)):(a=this,window.addEventListener("DOMContentLoaded",function(){a.handleDomLoaded.call(a)}))}function ca(){if(!(this instanceof ca))throw Error("AndroidBridge initialized without new keyword!");this.location="adobeDPS._bridge";this.out({event:{type:"BridgeInitialized",
bridgeLocation:this.location}});d.instance.info("BridgeInitialized - LOC: "+this.location)}function pa(a,b,c,e,d){this._listener=b;this._isOnce=c;this.context=e;this._signal=a;this._priority=d||0}function j(){this._bindings=[];this._prevParams=null}function da(){if(!(this instanceof da))throw Error("TransactionError initialized without new keyword!");this.code=0}function i(){if(!(this instanceof i))throw Error("Transaction initialized without new keyword!");this.stateChangedSignal=new j;this.completedSignal=
new j;this.progressSignal=new j;this.id=null;this.progress=this.state=0;this.error=new da;this.isDeterminate=this.isPausable=this.isCancelable=!1;this.isFailureTerminal=!0}function ea(){i.call(this)}function fa(){i.call(this)}function X(a,b){this.addedSubscriptions=a;this.removedSubscriptions=b;i.call(this)}function P(a){this.productId=a;i.call(this)}function Q(a,b,c){if(!c&&(!a||!b))throw Error("A token or a username and password must be provided for a UserSigninTransaction");this.username=a;this.password=
b;this.token=c;i.call(this)}function ga(){i.call(this)}function m(){}function h(){this.newTransactionsAvailableSignal=new j;this._allTransactions={};this._lastUID=null;this._lastUIDCounter=0;this.transactionStates=A;this.transactionErrorTypes=k}function x(){this.updatedSignal=new j;this.id=null;this.currentTransactions=[];this.downloadSize=null;this.state=qa.INVALID;this.title=this.previewImageURL=null;this.isUpdatable=this.isArchivable=this.isViewable=this.isDownloadable=this.isCompatible=!1}function y(){x.call(this);
this.filter=this.broker=this.price=this.description=this.folioDescription=this.publicationDate=this.folioNumber=this.productId=null;this.isThirdPartyEntitled=!1;this.targetDimensions=null;this.supportsContentPreview=this.isPurchasable=!1;this.receipt=null;this.entitlementType=ra.UNKNOWN;this.hasSections=!1;this.contentPreviewState=sa.NOT_REQUESTED;this.sections=new ha}function Y(){x.call(this);this.parentFolio=null;this.isAtHeadOfDownloadQueue=!1;this.index=0}function ha(){this.addedSignal=new j;
this.removedSignal=new j;this.internal={}}function u(){this.updatedSignal=new j;this.folioMap=new ha;this.folioStates=qa;this.folioContentPreviewStates=sa;this.currentTransaction=null}function l(a){this.folio=a;i.call(this);this.completedSignal.add(this._completedHandler,this)}function D(a){l.call(this,a)}function R(a,b,c){this.broker=a;this.productId=b;this.token=c;this.isSubscription=!1}function z(a,b,c,e,d){this.updatedSignal=new j;this.productId=a;this.title=b;this.duration=c;this.price=e;this.isOwned=
d||!1;this.receipt=null}function Z(a,b,c,e,d){this.startDate=e;this.endDate=d;R.call(this,a,b,c);this.isSubscription=!0}function $(){this.orientation=this.type=this.buttonTitle=this.label=this.buttonDisabledImage=this.buttonDownImage=this.buttonUpImage=this.buttonImage=null}function S(a){l.call(this,a)}function ia(a){l.call(this,a)}function M(a){l.call(this,a);this.step=0;this.isDeterminate=this.isCancelable=this.isPausable=!0;this.isFailureTerminal=!1}function T(a,b,c,e){this.isPortrait=b;this.width=
c;this.height=e;this.previewImageURL=null;l.call(this,a)}function ja(a){l.call(this,a)}function ka(a){l.call(this,a)}function aa(a){l.call(this,a);this.step=0;this.isDeterminate=this.isCancelable=this.isPausable=!0;this.isFailureTerminal=!1}function U(a){M.call(this,a)}function la(a){l.call(this,a)}function V(a){if(!a||a=="")throw Error("A non-empty productId has to be provided to get folio information.");this.productId=a;this.folios=[];i.call(this)}function ta(){this.updatedSignal=new j}function O(){this.isEnabled=
this.isSupported=!1;this.updatedSignal=new j}function q(){this.variables={}}function E(){this.updatedSignal=new j;this.userAuthenticationChangedSignal=new j;this.currentTransaction=null;this.isUserAuthenticated=!1;this.token=this.userName=null}function F(){this.applicationStates={};this.applicationStateTypes=ma;this.adobeApplicationVersion=this.applicationVersion=this.applicationID=null;this.callbacks={};this.applicationContext=null;this.applicationContextUpdatedSignal=new j}function v(){this.updatedSignal=
new j;this.isCustomWebviewDisplaying=this.isWelcomeScreenDisplaying=this.isCustomDialogDisplaying=!1}function K(){this.updatedSignal=new j;this.deviceName=this.os=this.deviceId=null;this.isOnline=this.isPurchasingEnabled=!1;this.networkType=null;this.networkTypes=va;this.advertisingIdentifier=this.identifierForVendor=this.omnitureVisitorId=this.pushNotificationToken=null;this.isAdvertisingTrackingEnabled=!1;this.callbacks={}}function s(){this.newReceiptsAvailableSignal=new j;this.updatedSignal=new j;
this.receipts={};this.subscriptionReceipts={};this.availableSubscriptions={};this.subscriptionsAddedSignal=new j;this.subscriptionsRemovedSignal=new j;this.entitlementTypes=ra;this.activeSubscription=null}function N(){this.autoArchive=O.instance}function wa(a,b,c,e,d,h,f){this.latitude=a;this.longitude=b;this.accuracy=e;this.altitude=c!==void 0?c:null;this.heading=d!==void 0?d:null;this.speed=h!==void 0?h:null;if(this.speed===0||this.speed===null)this.heading=NaN;this.altitudeAccuracy=f!==void 0?
f:null}function W(a,b){this.code=a||null;this.message=b||""}function xa(){this.enableHighAccuracy=!1;this.timeout=this.maximumAge=-1}function ya(a,b){return setTimeout(function(){var b=G.instance.callbacks[a];clearTimeout(b.timeout.timer);b.timeout.timer=null;b.fail&&b.fail({code:W.TIMEOUT,message:"Position retrieval timed out."})},b)}function G(){this.callbacks={};this.lastPosition=null}function t(){this.callbacks={}}function H(a){return!(a===void 0||a===null)}function n(a){return H(a)&&typeof a===
"function"}function ba(a,b){if(!n(a))throw Error(b);}function na(a){return H(a)&&typeof a==="string"&&a.length>0&&a.length<65&&a.search("['\"\\\n\r\t\u0008\u000c]+")===-1}function za(a,b){if(!H(a))return!1;if(!a.hasOwnProperty("eventsFilter")||!a.hasOwnProperty("enableRecordingStatusUI"))return!1;if(typeof a.enableRecordingStatusUI!=="boolean")return!1;var c=a.eventsFilter,e;for(e in c)if(c.hasOwnProperty(e)&&(typeof c[e]!=="string"||b.indexOf(c[e])===-1))return!1;return!0}function B(){this.recordings=
this.currentRecordingId=this.supportedEventAttributes=this.supportedEventNames=null;this.stateChangedSignal=new j;this.FolioActivityRecordingStates=Aa;this.FolioActivityErrorCodes=I;this.callbackId=Math.floor(Math.random()*2E9);this.callbacks={}}function n(a){return o(a)&&typeof a==="function"}function o(a){return!(a===void 0||a===null)}function C(){this.oauthData=this.redirectURI=this.clientId=null;this.OAuthRedirectServiceErrorCodes=p;this.timer=this.responseHandler=this.callback=null;this.timeout=
12E4;this.callbackId=Math.floor(Math.random()*2E9)}function f(){try{d.instance.enableLogging=!0,d.instance.debug("Interface initialized"),this.version=1.4,this.uid=this._generateUID(),this.initializationComplete=new j,this.initializationComplete.memorize=!0,this._bridge=w.instance,this.libraryService=u.instance,this.transactionManager=h.instance,this.authenticationService=E.instance,this.deviceService=K.instance,this.receiptService=s.instance,this.settingsService=N.instance,this.analyticsService=
q.instance,this.configurationService=F.instance,this.dialogService=v.instance,this.geolocation=null,this.calendarService=t.instance,this.folioActivityService=this.oauthRedirectService=null,this.log=d.instance,this._bridge.out({event:{type:"LibraryAPIReady",version:this.version,id:this.uid}}),d.instance.info("LibraryAPIReady - V: "+this.version+", ID: "+this.uid)}catch(a){d.instance.error(a)}}J.prototype.toString=function(){var a=/(\w+)\(/.exec(this.constructor.toString())[1];this.hasOwnProperty("id")&&
(a+="["+this.id+"]");return a};J.extend=function(a){var b,c;b=this.prototype;c=function(){};c.prototype=b;b=new c;a.prototype=b;a.prototype.constructor=a;a.extend=J.extend};d.prototype.error=function(a){if(this.enableLogging){var b=!1;try{a?this._logList.push(new L(this.logLevels.ERROR,a.message+"\n"+printStackTrace({e:a}).join("\n"))):this._logList.push(new L(this.logLevels.ERROR,a.message+"\n"+printStackTrace().join("\n"))),b=!0}catch(c){}finally{b||this._logList.push(new L(this.logLevels.ERROR,
a.message))}}};d.prototype.warn=function(a){this.enableLogging&&this._logList.push(new L(this.logLevels.WARN,a))};d.prototype.info=function(a){this.enableLogging&&this._logList.push(new L(this.logLevels.INFO,a))};d.prototype.debug=function(a){this.enableLogging&&this._logList.push(new L(this.logLevels.DEBUG,a))};d.prototype.profile=function(a){if(this.enableLogging){var b;this._profileTimers.hasOwnProperty(a)?(b=Date.now()-this._profileTimers[a],this._logList.push(new L(this.logLevels.PROFILE,a+": "+
b+"ms"))):this._profileTimers[a]=Date.now()}};d.prototype.bridge=function(a){this.enableLogging&&this._logList.push(new L(this.logLevels.BRIDGE,a))};d.prototype.print=function(a,b){if(this.enableLogging){var c,e,d="";for(c=0;c<this._logList.length;c++)e=this._logList[c],a&e.lvl&&(d+=this._lvlToStr(e.lvl),d+=b?" ["+e.timestamp.getTime()+"] ":" - ",d+=e.msg+"\n");return d}else return""};d.prototype.clear=function(){if(this.enableLogging)this._logList.length=0};d.prototype._lvlToStr=function(a){switch(a){case this.logLevels.BRIDGE:return"BRIDGE";
case this.logLevels.DEBUG:return"DEBUG";case this.logLevels.PROFILE:return"PROFILE";case this.logLevels.INFO:return"INFO";case this.logLevels.WARN:return"WARN";case this.logLevels.ERROR:return"ERROR";default:return"LOG"}};d.instance=new d;d.prototype.logLevels={BRIDGE:1,DEBUG:2,PROFILE:4,INFO:8,WARN:16,ERROR:32};J.extend(w);w.prototype.handleDomLoaded=function(){this.bridgeBusy=!1;this.out({event:{type:"BridgeInitialized",bridgeLocation:this.location}});d.instance.info("BridgeInitialized - LOC: "+
this.location)};w.prototype.out=function(a,b){var c,e;if(window.boolAdobeDPSWebViewer!==!0)if(!this.bridgeBusy||b){this.bridgeBusy=!0;if(a instanceof Array){e="[";for(c=0;c<a.length;c++)e+=JSON.stringify(a[c])+(c<a.length-1?",":"");e+="]"}else e=JSON.stringify(a);this.sentData=e.length;this.sendTime=(new Date).getTime();this.totalSends++;window.location=this.BRIDGE_PREFIX_URI+encodeURIComponent(e);d.instance.bridge("OUT - "+e)}else this.bridgeMessageQueue.push(a)};w.prototype.partialInput=function(a,
b,c,e){var g="";try{if(e===!0){if(this.messageBuffer[a]&&this.messageBuffer[a].length){for(e=0;e<b;++e)g+=this.messageBuffer[a][e];d.instance.bridge("EXECUTE ("+a+" [ "+b.toString()+" ]) - "+c);this.input(JSON.parse(g),c);this.messageBuffer[a].length=0}}else this.messageBuffer[a]||(this.messageBuffer[a]=[]),d.instance.bridge("APPEND ("+a+" [ "+b.toString()+" ]) - "+c.length.toString()),this.messageBuffer[a][b]=c}catch(h){d.instance.error(h)}};w.prototype.input=function(a,b){if(window.boolAdobeDPSWebViewer!==
!0)try{switch(d.instance.bridge("INPUT("+b+") - "+JSON.stringify(a)),b){case "_initialize":f.instance._initialize(a);break;case "_update":f.instance._update(a);break;default:d.instance.warn("Bridge.input received call for unknown endpoint: "+b)}}catch(c){d.instance.error(c)}};w.prototype.notifyReceivedBridgeData=function(){this.bridgeBusy=!1;this.updateMetrics();this.processQueue()};w.prototype.updateMetrics=function(){var a;a=this.sentData/1024/(((new Date).getTime()-this.sendTime)/1E3);this.metrics[0]>
a&&(this.metrics[0]=a);this.metrics[1]<a&&(this.metrics[1]=a);this.metrics[2]=(this.metrics[2]*(this.totalSends-1)+a)/this.totalSends;this.logMetrics()};w.prototype.logMetrics=function(){this.metricsLogTimeout&&clearTimeout(this.metricsLogTimeout);var a=this;this.metricsLogTimeout=setTimeout(function(){a.totalSends=1;d.instance.info("Bridge BW - Min: "+a.metrics[0].toFixed(2)+"KB/s, Max: "+a.metrics[1].toFixed(2)+"KB/s, Avg: "+a.metrics[2].toFixed(2)+"KB/s")},1E3)};w.prototype.processQueue=function(){if(this.bridgeMessageQueue.length>
0)this.out(this.bridgeMessageQueue),this.bridgeMessageQueue.length=0};w.extend(ca);ca.prototype.out=function(a){var b,c;if(window.boolAdobeDPSWebViewer!==!0){if(a instanceof Array){c="[";for(b=0;b<a.length;b++)c+=JSON.stringify(a[b])+(b<a.length-1?",":"");c+="]"}else c=JSON.stringify(a);_adobedps_native_bridge.out(c);d.instance.bridge("OUT - "+c)}};typeof _adobedps_native_bridge!=="undefined"?(d.instance.info("Using Android Bridge"),w.instance=new ca):(d.instance.info("Using Location Bridge"),w.instance=
new w);d.instance.profile("InitializationTime");pa.prototype={active:!0,params:null,execute:function(a){var b;this.active&&this._listener&&(a=this.params?this.params.concat(a):a,b=this._listener.apply(this.context!==void 0?this.context:window,a),this._isOnce&&this.detach());return b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;
delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};j.validateListener=function(a,b){if(typeof a!=="function")throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));};j.prototype={memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,e){var d=this._indexOfListener(a,c);if(d!==-1){if(a=
this._bindings[d],a.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(!b?"":"Once")+"() the same listener without removing the relationship first.");}else a=new pa(this,a,b,c,e),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c=this._bindings.length,
e;c--;)if(e=this._bindings[c],e._listener===a&&e.context===b)return c;return-1},has:function(a,b){return this._indexOfListener(a,b)!==-1},add:function(a,b,c){j.validateListener(a,"add");return this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){j.validateListener(a,"addOnce");return this._registerListener(a,!0,b,c)},remove:function(a,b){j.validateListener(a,"remove");var c=this._indexOfListener(a,b);c!==-1&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return a},removeAll:function(){for(var a=
this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b=Array.prototype.slice.call(arguments),c=this._bindings.length,e;if(this.memorize)this._prevParams=b;if(c){e=this._bindings.slice();this._shouldPropagate=!0;do c--;while(e[c]&&this._shouldPropagate&&e[c].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();
delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var k={TransactionCannotConnectToInternetError:-100,TransactionCannotConnectToServerError:-110,TransactionAuthenticationUnrecognizedCredentialsError:-150,TransactionFolioPurchasingDisabledError:-200,TransactionFolioCannotPurchaseError:-210,TransactionSubscriptionCannotPurchaseError:-220,TransactionSubscriptionResolveError:-225,TransactionRestorePurchasesError:-250,
TransactionQuotaExceededError:-300,TransactionFolioIncompatibleError:-400,TransactionFolioNotEnoughDiskSpaceError:-500,TransactionFolioCannotDownloadError:-510,TransactionFolioFileMissingOrInvalid:-520,TransactionFolioCannotInstallItemError:-530,TransactionFolioNoPreviewAvailable:-540,TransactionFolioNotFoundOnServer:-550,TransactionFolioCallNotApplicable:-560,TransactionInternalError:-900,toErrorType:function(a){switch(parseInt(a,10)){case -100:return k.TransactionCannotConnectToInternetError;case -110:return k.TransactionCannotConnectToServerError;
case -150:return k.TransactionAuthenticationUnrecognizedCredentialsError;case -151:return k.TransactionAuthenticationCancelError;case -200:return k.TransactionFolioPurchasingDisabledError;case -210:return k.TransactionFolioCannotPurchaseError;case -211:return k.TransactionFolioPurchaseCancelError;case -220:return k.TransactionSubscriptionCannotPurchaseError;case -221:return k.TransactionSubscriptionPurchaseCancelError;case -225:return k.TransactionSubscriptionResolveError;case -250:return k.TransactionRestorePurchasesError;
case -251:return k.TransactionRestorePurchaseCancelError;case -300:return k.TransactionQuotaExceededError;case -400:return k.TransactionFolioIncompatibleError;case -500:return k.TransactionFolioNotEnoughDiskSpaceError;case -510:return k.TransactionFolioCannotDownloadError;case -520:return k.TransactionFolioFileMissingOrInvalid;case -530:return k.TransactionFolioCannotInstallItemError;case -540:return k.TransactionFolioNoPreviewAvailable;case -550:return k.TransactionFolioNotFoundOnServer;case -560:return k.TransactionFolioCallNotApplicable;
case -900:return k.TransactionInternalError;default:throw Error("Invalid TransactionError: "+a);}}};J.extend(da);var A={FAILED:-100,CANCELED:-1,INITIALIZED:0,PAUSED:100,ACTIVE:200,FINISHED:400,toState:function(a){switch(parseInt(a,10)){case -100:return A.FAILED;case -1:return A.CANCELED;case 0:return A.INITIALIZED;case 100:return A.PAUSED;case 200:return A.ACTIVE;case 400:return A.FINISHED;default:throw Error("Invalid TransactionState: "+a);}}};J.extend(i);i.prototype.isFolioStateChangingTransaction=
function(){return this instanceof D};i.prototype.start=function(){if(this.state!=A.INITIALIZED)throw Error("Attempting to start an ongoing Transaction! State: "+this.state);else return f.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"start"}}),this};i.prototype.pause=function(){if(this.isPausable)f.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"pause"}});else throw Error("Attempting to pause a non-pausable Transaction!");
return this};i.prototype.resume=function(){if(this.state!=A.PAUSED)throw Error("Attempting to resume a non-paused Transaction! State: "+this.state);else f.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"resume"}});return this};i.prototype.cancel=function(){if(this.isCancelable)f.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"cancel"}});else throw Error("Attempting to cancel a non-cancelable Transaction!");
return this};i.prototype._isSuspendable=function(){return!1};i.prototype._suspend=function(){if(this._isSuspendable())f.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"suspend"}});else throw Error("Attempting to suspend a non-suspendable Transaction!");return this};i.prototype.jsonClassName="Transaction";i.prototype._toJSON=function(){return{type:this.jsonClassName,id:this.id}};i.prototype._updateFromJSON=function(a){var b;if(this.id===null&&a.hasOwnProperty("id"))this.id=
a.id;if(a.hasOwnProperty("error")&&(b=a.error,b!==null&&b.hasOwnProperty("code"))){this.error=new da;try{this.error.code=k.toErrorType(b.code),d.instance.warn(this.jsonClassName+" error: "+this.error.code)}catch(c){d.instance.error(c)}}if(a.hasOwnProperty("isCancelable"))this.isCancelable=a.isCancelable;if(a.hasOwnProperty("isPausable"))this.isPausable=a.isPausable;if(a.hasOwnProperty("isDeterminate"))this.isDeterminate=a.isDeterminate;if(a.hasOwnProperty("state")){b=this.state;try{b=A.toState(a.state)}catch(e){d.instance.error(e)}if(this.state!=
b)this.state=b,this.stateChangedSignal.dispatch(this)}if(a.hasOwnProperty("progress")&&(a=Number(a.progress),this.progress!=a))this.progress=a,this.progressSignal.dispatch(this)};i.extend(ea);ea.prototype.jsonClassName="LibraryUpdateTransaction";i.extend(fa);fa.prototype.jsonClassName="RestorePurchasesTransaction";i.extend(X);X.prototype.jsonClassName="ModifySubscriptionsListTransaction";X.prototype._toJSON=function(){var a,b,c,e;b=i.prototype._toJSON.call(this);e=[];for(a=0;a<this.addedSubscriptions.length;a++)c=
this.addedSubscriptions[a],e.push(c._toJSON());b.addedSubscriptions=e;b.removedSubscriptions=this.removedSubscriptions;return b};i.extend(P);P.prototype.jsonClassName="SubscribeTransaction";P.prototype._toJSON=function(){var a=i.prototype._toJSON.call(this);a.productId=this.productId;return a};P.prototype._updateFromJSON=function(a){i.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("productId"))this.productId=a.productId};i.extend(Q);Q.prototype.jsonClassName="UserSigninTransaction";Q.prototype._toJSON=
function(){var a=i.prototype._toJSON.call(this);a.username=this.username;a.password=this.password;a.token=this.token;return a};Q.prototype._updateFromJSON=function(a){i.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("username"))this.username=a.username;if(a.hasOwnProperty("password"))this.password=a.password;if(a.hasOwnProperty("token"))this.token=a.token};i.extend(ga);ga.prototype.jsonClassName="UserSignoutTransaction";J.extend(m);m.prototype._getNextPathElement=function(a){var b=a.indexOf(".");
return b>-1?a.substring(0,b):a};m.prototype._getChildPath=function(a){var b=a.indexOf(".");return b>-1?a.substring(b+1):""};m.prototype._initialize=function(){};m.prototype._update=function(){};m.extend(h);h.prototype.activeTransactions=function(){var a={},b,c;for(b in this._allTransactions)c=this._allTransactions[b],c.state==i.ACTIVE&&(a[b]=this._allTransactions[b]);return a};h.prototype.allTransactions=function(){var a={},b;for(b in this._allTransactions)a[b]=this._allTransactions[b];return a};
h.prototype._registerTransaction=function(a,b){if(!a.hasOwnProperty("id")||a.id===null)a.id=this._generateUID();this._allTransactions[a.id]=a;a.completedSignal.add(function(a){d.instance.debug("Transaction "+a.id+" completed");delete this._allTransactions[a.id]},this,-Infinity);this._didOriginateHere(a)&&!b&&(f.instance._send({action:"add",path:"transactionManager",data:a._toJSON()}),d.instance.debug("Registered transaction "+a.id+" with native app"));return a};h.prototype._didOriginateHere=function(a){a=
a.id.split("-");return a.length>0&&a[0]==f.instance.uid?!0:!1};h.prototype._generateUID=function(){var a=f.instance.uid+"-",b=(new Date).getTime();return b!=this._lastUID?(this._lastUID=b,this._lastUIDCounter=0,a+b.toString()):(this._lastUIDCounter++,a+b.toString()+this._lastUIDCounter)};h.prototype._transactionVOProcess=function(a){var b=null;switch(a.type){case "DownloadTransaction":b=new M;break;case "ArchiveTransaction":b=new ia;break;case "LibraryUpdateTransaction":b=new ea;break;case "PreviewImageTransaction":b=
new T;break;case "PurchaseTransaction":b=new ja;break;case "RestorePurchasesTransaction":b=new fa;break;case "ModifySubscriptionsListTransaction":b=new X([],[]);break;case "SubscribeTransaction":b=new P;break;case "UserSigninTransaction":b=new Q;break;case "UserSignoutTransaction":b=new ga;break;case "ViewTransaction":b=new ka;break;case "UpdateTransaction":b=new aa;break;case "CheckPreviewAvailabilityTransaction":b=new S;break;case "PreviewTransaction":b=new U;break;case "FolioSectionListUpdateTransaction":b=
new la;break;case "FolioInfoTransaction":b=new V;break;default:d.instance.info("TransactionManager received unknown Transaction: "+a.type)}b!==null&&b._updateFromJSON(a);return b};h.prototype._update=function(a){var b,c,e;if(a.hasOwnProperty("add")){b=a.add;c=[];for(e=0;e<b.length;e++)a=this._transactionVOProcess(b[e]),a!==null&&(this._registerTransaction(a),c.push(a));c.length>0?(this.newTransactionsAvailableSignal.dispatch(c),d.instance.debug("TransactionManager._update added "+c.length+" transactions")):
d.instance.warn("TransactionManager._update (add) called with add that didn't add any transactions")}else a.hasOwnProperty("remove")?(c=a.remove,(a=this._allTransactions[c])?(a.completedSignal.dispatch(a),d.instance.debug("TransactionManager._update removed "+a.id)):d.instance.warn("TransactionManager._update (remove) called with unknown Transaction: "+c)):a.hasOwnProperty("update")&&a.path.indexOf("_allTransactions")>-1?(b=a.update,c=a.path.indexOf("']"),c=a.path.substring(18,c),(a=this._allTransactions[c])?
a._updateFromJSON(b):d.instance.warn("TransactionManager._update called with unknown Transaction: "+c)):d.instance.warn("TransactionManager._update (update) cannot parse update: "+JSON.stringify(a))};h.prototype._initialize=function(a){var b,c,e;if(a.hasOwnProperty("update")){if(a=a.update,a.hasOwnProperty("_allTransactions")){b=[];for(c=0;c<a._allTransactions.length;c++)e=a._allTransactions[c],e=this._transactionVOProcess(e),e!==null&&(b.push(e),this._registerTransaction(e,!0));b.length>0&&(d.instance.debug("TransactionManager._initialize registered "+
b.length+" new Transactions"),this.newTransactionsAvailableSignal.dispatch(b))}}else d.instance.warn("TransactionManager._initialize called without update")};h.instance=new h;var qa={INVALID:0,UNAVAILABLE:50,PURCHASABLE:100,PURCHASING:101,ENTITLED:200,DOWNLOADING:201,EXTRACTABLE:400,EXTRACTING:401,INSTALLED:1E3},sa={NOT_REQUESTED:0,REQUESTED:1,UNAVAILABLE:2,AVAILABLE:3,DISABLED:4};m.extend(x);x.prototype.download=function(){if(!this.isDownloadable)throw Error("Attempting to download a baseFolio that is not downloadable");
if(!this.isCompatible)throw Error("Attempting to download an incompatible baseFolio.");var a=new M(this);if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new DownloadTransaction on "+this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the DownloadTransaction.");};x.prototype.view=function(){if(!this.isViewable)throw Error("Attempting to view a baseFolio that is not viewable! You must check isViewable before attempting to view a baseFolio.");
if(!this.isCompatible)throw Error("Attempting to view an incompatible baseFolio.");var a=new ka(this);if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new ViewTransaction on "+this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the ViewTransaction.");};x.prototype.getPreviewImage=function(a,b,c){if(a=new T(this,c,a,b)){h.instance._registerTransaction(a);d.instance.debug("Starting new PreviewImageTransaction on "+
this.id);try{return a.start()}catch(e){throw delete h.instance._allTransactions[a.id],e;}}else throw Error("There was a problem creating the PreviewImageTransaction.");};x.prototype.currentStateChangingTransaction=function(){var a,b;for(a=0;a<this.currentTransactions.length;a++)if(b=this.currentTransactions[a],b instanceof D)return b;return null};x.prototype._update=function(a){a.hasOwnProperty("update")?this._updateFromJSON(a.update):d.instance.warn("BaseFolio._update ("+this.id+") cannot parse update: "+
a)};x.prototype._updateFromJSON=function(a){var b,c,e=[];for(b in a)b in this?(c=this._processPropertyUpdate(a[b],b),this[b]!=c&&(this[b]=c,e.push(b))):d.instance.warn("Found invalid property in baseFolio update: "+b+"-"+a[b]);e.length>0&&this.updatedSignal.dispatch(e)};x.prototype._processPropertyUpdate=function(a,b){var c=[],e,d,f;switch(b){case "currentTransactions":c=[];e=a.length;for(f=0;f<e;f++){if((d=h.instance._allTransactions[a[f]])&&d.folio!==this)d.folio=this;d&&c.push(d)}return c;default:return a}};
x._fromJSON=function(a){var b=new x;b._updateFromJSON(a);return b};x.extend(y);y.prototype.verifyContentPreviewSupported=function(){var a,b;for(a=0;a<this.currentTransactions.length;a++)if(b=this.currentTransactions[a],b instanceof S)return b;if(a=new S(this)){h.instance._registerTransaction(a);d.instance.debug("Starting new ContentPreviewAvailabilityTransaction on "+this.id);try{return a.start()}catch(c){throw delete h.instance._allTransactions[a.id],c;}}else throw Error("There was a problem creating the ContentPreviewAvailabilityTransaction.");
};y.prototype.canDownloadContentPreview=function(){return this.supportsContentPreview&&!this.hasSections&&this.isPurchasable&&this.isCompatible&&!this.isArchivable&&this.currentStateChangingTransaction()==null};y.prototype.downloadContentPreview=function(){if(!this.canDownloadContentPreview())throw Error("Attempting to preview a Folio that cannot be previewed! You must check canDownloadContentPreview() before attempting to preview a Folio.");var a=new U(this);if(a){h.instance._registerTransaction(a);
d.instance.debug("Starting new PreviewContentTransaction on "+this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the PreviewContentTransaction.");};y.prototype.purchase=function(){if(!this.isPurchasable)throw Error("Attempting to purchase a folio that is not purchasable");if(!this.isCompatible)throw Error("Attempting to purchase an incompatible folio.");var a=new ja(this);if(a){h.instance._registerTransaction(a);
d.instance.debug("Starting new PurchaseTransaction on "+this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the PurchaseTransaction.");};y.prototype.isFree=function(){return this.broker=="noChargeStore"};y.prototype.update=function(){if(!this.isUpdatable)throw Error("Attempting to update a Folio that is not updatable! You must check isUpdatable before attempting to update a Folio.");if(!this.isCompatible)throw Error("Attempting to update an incompatible Folio.");
var a=new aa(this);if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new UpdateTransaction on "+this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the UpdateTransaction.");};y.prototype.archive=function(){if(!this.isArchivable)throw Error("Attempting to archive a Folio that is not archivable! You must always check isArchivable before attempting to archive a Folio.");if(!this.isCompatible)throw Error("Attempting to archive an incompatible Folio.");
var a=new ia(this);if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new ArchiveTransaction on "+this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the ArchiveTransaction.");};y.prototype.getSections=function(){if(!this.hasSections)throw Error("Attempting to get sections on a folio that does not have sections");var a=new la(this);if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new FolioSectionListUpdateTransaction on "+
this.id);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the FolioSectionListUpdateTransaction.");};y.prototype._processPropertyUpdate=function(a,b){var c,e,d;switch(b){case "publicationDate":return new Date(parseInt(a,10));case "sections":for(c=0;c<a.length;c++)if(e=a[c],e.type=="Section")delete e.type,d=Y._fromJSON(e),d.parentFolio=this,this.sections.internal[e.id]=d;return this.sections;default:return x.prototype._processPropertyUpdate.call(this,
a,b)}};y.prototype._update=function(a){var b,c,e,g;e=this._getNextPathElement(a.path);if(e.indexOf("sections")>-1&&(b=e.indexOf("']"),e=e.substring(10,b),e=this.sections.internal[e])){a.path=this._getChildPath(a.path);e._update(a);return}if(a.hasOwnProperty("update"))this._updateFromJSON(a.update);else if(a.hasOwnProperty("add")){a=a.add;b=[];for(g=0;g<a.length;g++)c=a[g],e=null,c.type=="Section"?(delete c.type,e=Y._fromJSON(c)):d.instance.warn("Folio._update ("+this.id+") called with an invalid typed add: "+
c.type),e!==null?(e.parentFolio=this,this.sections.internal[c.id]=e,b.push(e)):d.instance.warn("Folio._update ("+this.id+") failed to parse added folio: "+folioVO.id);b.length>0?(this.sections.addedSignal.dispatch(b),d.instance.debug("Folio._update ("+this.id+") added "+b.length+" sections")):d.instance.warn("Folio._update ("+this.id+") called with add that didn't add any sections")}else if(a.hasOwnProperty("remove")){a=a.remove;b=[];for(g=0;g<a.length;g++)e=this.sections.internal[a[g]],e!==null?
(delete this.sections.internal[e.id],b.push(e)):d.instance.warn("Folio._update ("+this.id+") failed to parse removed section: "+a[g]);b.length>0?(this.sections.removedSignal.dispatch(b),d.instance.debug("Folio ("+this.id+") removed "+b.length+" sections")):d.instance.warn("Folio._update ("+this.id+") called with remove that didn't remove any sections")}else d.instance.warn("Folio._update ("+this.id+") cannot parse update: "+a)};y._fromJSON=function(a){var b=new y;b._updateFromJSON(a);return b};x.extend(Y);
Y._fromJSON=function(a){var b=new Y;b._updateFromJSON(a);return b};ha.prototype.sort=function(a){var b=[],c;for(c in this.internal)b.push(this.internal[c]);b.sort(a);return b};ha.prototype.getByProductId=function(a){var b,c;for(b in this.internal)if(c=this.internal[b],c.productId==a)return c;d.instance.warn("Unknown productId requested: "+a);return null};m.extend(u);u.prototype.updateLibrary=function(){if(this.currentTransaction!==null)throw Error("Attempting to update when Library is already being updated.");
var a=new ea;if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new LibraryUpdateTransaction");try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the LibraryUpdateTransaction.");};u.prototype._initialize=function(a){var b,c;if(a.hasOwnProperty("update"))if(a=a.update,a.hasOwnProperty("folioMap")){for(b=0;b<a.folioMap.length;b++)c=a.folioMap[b],c.type=="Folio"&&(delete c.type,this.folioMap.internal[c.id]=
y._fromJSON(c));d.instance.debug("LibraryService._initialize added "+a.folioMap.length+" folios")}else d.instance.warn("LibraryService._initialize called without a folioMap");else d.instance.warn("LibraryService._initialize called without an update element")};u.prototype._update=function(a){d.instance.debug("LibraryService._update called: "+JSON.stringify(a));var b,c,e,g;b=this._getNextPathElement(a.path);if(b.indexOf("folioMap")>-1&&(g=b.indexOf("']"),g=b.substring(10,g),g=this.folioMap.internal[g])){a.path=
this._getChildPath(a.path);g._update(a);return}if(a.hasOwnProperty("add")){a=a.add;b=[];for(c=0;c<a.length;c++)e=a[c],g=null,e.type=="Folio"?(delete e.type,g=y._fromJSON(e)):d.instance.warn("LibraryService._update called with an invalid typed add: "+e.type),g!==null?(this.folioMap.internal[e.id]=g,b.push(g)):d.instance.warn("LibraryService._update failed to parse added folio: "+e.id);b.length>0?(this.folioMap.addedSignal.dispatch(b),d.instance.debug("LibraryService._update added "+b.length+" folios")):
d.instance.warn("LibraryService._update called with add that didn't add any folios")}else if(a.hasOwnProperty("remove")){a=a.remove;b=[];for(c=0;c<a.length;c++)g=this.folioMap.internal[a[c]],g!==null?(delete this.folioMap.internal[g.id],b.push(g)):d.instance.warn("LibraryService._update failed to parse removed folio: "+a[c]);b.length>0?(this.folioMap.removedSignal.dispatch(b),d.instance.debug("Removed "+b.length+" folios")):d.instance.warn("LibraryService._update called with remove that didn't remove any folios")}else d.instance.warn("LibraryService._update cannot parse update: "+
a)};u.prototype._internalGetFolioInfo=function(a){if(a=new V(a)){h.instance._registerTransaction(a);d.instance.debug("Starting new FolioInfoTransaction");try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the FolioInfoTransaction.");};u.prototype.getFolioInfo=function(a){return this._internalGetFolioInfo(a)};u.prototype.getFolioInfoAsEntitled=function(a){return this.getFolioInfo(a)};u.instance=new u;i.extend(l);l.prototype.start=
function(){this.folio.currentTransactions.indexOf(this)==-1&&(this.folio.currentTransactions.push(this),this.folio.updatedSignal.dispatch(["currentTransactions"]));return i.prototype.start.call(this)};l.prototype._completedHandler=function(a){var b;if(a.state==A.FINISHED||a.state==A.FAILED||a.state==A.CANCELED)b=a.folio.currentTransactions.indexOf(this),b>-1&&(a.folio.currentTransactions.splice(b,1),a.folio.updatedSignal.dispatch(["currentTransactions"]),d.instance.debug("Transaction "+this.id+" finished: "+
this.state))};l.prototype.jsonClassName="FolioTransaction";l.prototype._toJSON=function(){var a=i.prototype._toJSON.call(this);a.folio=this.folio.id;return a};l.prototype._updateFromJSON=function(a){i.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("folio")){var b;if(typeof u!="undefined")b=u.instance.folioMap.internal[a.folio];else if(typeof ReadingService!="undefined"&&ReadingService.instance.currentFolio.id==a.folio)b=ReadingService.instance.currentFolio;if(b)this.folio=b,b.currentTransactions.indexOf(this)==
-1&&(b.currentTransactions.push(this),b.updatedSignal.dispatch(["currentTransactions"]))}};l.extend(D);l.prototype.jsonClassName="FolioStateChangingTransaction";D.prototype.start=function(){var a,b;for(a=0;a<this.folio.currentTransactions.length;a++)if(b=this.folio.currentTransactions[a],b!==this&&b instanceof D&&!b._isSuspendable())throw Error("Attempting to start a FolioStateChangingTransaction on a folio that already has another FolioStateChangingTransaction acting on it: "+b.id);return l.prototype.start.call(this)};
var ra={UNKNOWN:0,FREE:1,SINGLE:2,SUBSCRIPTION:3,THIRD_PARTY:4,PROMOTIONAL:5};J.extend(R);z.prototype.jsonClassName="Subscription";z.prototype.purchase=function(){if(this.isActive())throw Error("Subscription "+this.productId+" has already been purchased.");var a=new P(this.productId);if(a){h.instance._registerTransaction(a);try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the SubscribeTransaction.");};z.prototype.isActive=
function(){return this.isOwned&&this.receipt.contains(new Date)?!0:!1};z.prototype._toJSON=function(){return{type:this.jsonClassName,productId:this.productId,title:this.title,duration:this.duration,price:this.price,isOwned:this.isOwned}};z.prototype._updateFromJSON=function(a){var b=[],c;for(c in a)this.hasOwnProperty(c)?this[c]!=a[c]&&(this[c]=this._processPropertyUpdate(a[c],c),b.push(c)):d.instance.warn("Found invalid property in subscription update: "+c+"-"+a[c]);b.length>0&&this.updatedSignal.dispatch(b)};
z.prototype._processPropertyUpdate=function(a){return a};z._fromJSON=function(a){var b=new z;b._updateFromJSON(a);return b};R.extend(Z);Z.prototype.contains=function(a){return a>=this.startDate&&a<=this.endDate?!0:!1};var ma={NATIVE:"builtin",WEBVIEW:"webview"};J.extend($);$._fromJSON=function(a){var b=new $;b.buttonUpImage=a.upImage;b.buttonDownImage=a.downImage;b.buttonDisabledImage=a.disabledImage;b.buttonImage=a.imagePath;b.label=a.label;b.buttonTitle=a.buttonTitle;b.type=a.stateType;b.orientation=
a.orientation;return b};$.prototype.gotoState=function(){F.instance.gotoState(this.label)};l.extend(S);S.prototype._updateFromJSON=function(a){l.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("previewAvailable")&&this.folio.supportsContentPreview!=a.previewAvailable)this.folio.supportsContentPreview=a.previewAvailable,this.folio.updatedSignal.dispatch(["supportsContentPreview"])};S.prototype.jsonClassName="CheckPreviewAvailabilityTransaction";D.extend(ia);ia.prototype.jsonClassName="ArchiveTransaction";
D.extend(M);M.prototype._updateFromJSON=function(a){if(a.hasOwnProperty("step"))this.step=a.step;D.prototype._updateFromJSON.call(this,a)};M.prototype.jsonClassName="DownloadTransaction";l.extend(T);T.prototype.jsonClassName="PreviewImageTransaction";T.prototype._toJSON=function(){var a=l.prototype._toJSON.call(this);a.isPortrait=this.isPortrait;a.width=this.width;a.height=this.height;return a};T.prototype._updateFromJSON=function(a){l.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("isPortrait"))this.isPortait=
a.isPortrait;if(a.hasOwnProperty("width"))this.width=a.width;if(a.hasOwnProperty("height"))this.height=a.height;if(a.hasOwnProperty("previewImageURL"))this.previewImageURL=a.previewImageURL};D.extend(ja);ja.prototype.jsonClassName="PurchaseTransaction";l.extend(ka);ka.prototype.jsonClassName="ViewTransaction";D.extend(aa);aa.prototype._updateFromJSON=function(a){D.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("step"))this.step=a.step};aa.prototype.jsonClassName="UpdateTransaction";M.extend(U);
U.prototype._isSuspendable=function(){return!0};U.prototype._updateFromJSON=function(a){M.prototype._updateFromJSON.call(this,a);if(this.error.code==k.TransactionFolioNoPreviewAvailable)this.folio.supportsContentPreview=!1,adobeDPS.log.debug("Transaction failed with error:TransactionFolioNoPreviewAvailable"),this.folio.updatedSignal.dispatch(["supportsContentPreview"])};U.prototype.jsonClassName="PreviewTransaction";l.extend(la);la.prototype.jsonClassName="FolioSectionListUpdateTransaction";i.extend(V);
V.prototype.jsonClassName="FolioInfoTransaction";V.prototype._toJSON=function(){var a=i.prototype._toJSON.call(this);a.productId=this.productId;a.folios=this.folios;return a};V.prototype._updateFromJSON=function(a){i.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("folios"))for(var b=0;b<a.folios.length;++b){var c=u.instance.folioMap.internal[a.folios[b]];c&&this.folios.push(c)}};m.extend(ta);ta.extend(O);O.prototype.toggle=function(a){this.isSupported&&a!=this.isEnabled&&(d.instance.debug("Setting autoArchive to: "+
a),f.instance._send({action:"call",path:"settingsService.autoArchive",data:{method:"toggle"}}))};O.prototype._update=function(a){var b;if(a.hasOwnProperty("update")){b=[];a=a.update;if(a.hasOwnProperty("isSupported"))this.isSupported=a.isSupported,b.push("isSupported");if(a.hasOwnProperty("isEnabled"))this.isEnabled=a.isEnabled,b.push("isEnabled");b.length>0&&this.updatedSignal.dispatch(b)}else d.instance.warn("AutoArchive._update cannot parse update: "+JSON.stringify(a))};O.prototype._initialize=
function(a){this._update(a)};O.instance=new O;m.extend(q);q.ALLOWED_VARIABLES="stackId,screenId,stackTitle,overlayId,overlayType,isOnline,folioManifestId,isAdView,productId,entitlementCategory,purchasePrice,purchaseUnits,isAutoStarted,customVariable1,customVariable2,customVariable3,customVariable4,customVariable5,customVariable6,customVariable7,customVariable8,customVariable9,customVariable10".split(",");q.ALLOWED_EVENTS="customEvent1,customEvent2,customEvent3,customEvent4,customEvent5,customEvent6,customEvent7,customEvent8,customEvent9,customEvent10".split(",");
q.PURCHASE_CATEGORIES={subscription:"subscription",single:"single",free:"free",external:"external"};q.prototype._variableAliases={stackIndex:"stackId",stackId:"stackId",screenIndex:"screenId",screenId:"screenId",adTitle:"stackTitle",articleTitle:"stackTitle",stackTitle:"stackTitle",overlayId:"overlayId",overlayType:"overlayType",isOnline:"isOnline",issueName:"folioManifestId",folioManifestId:"folioManifestId",isAdView:"isAdView",productId:"productId",entitlementCategory:"entitlementCategory",purchasePrice:"purchasePrice",
purchaseUnits:"purchaseUnits",isAutoStarted:"isAutoStarted",customVariable1:"customVariable1",customVariable2:"customVariable2",customVariable3:"customVariable3",customVariable4:"customVariable4",customVariable5:"customVariable5",customVariable6:"customVariable6",customVariable7:"customVariable7",customVariable8:"customVariable8",customVariable9:"customVariable9",customVariable10:"customVariable10"};q.prototype._eventAliases={customEvent1:"customEvent1",customEvent2:"customEvent2",customEvent3:"customEvent3",
customEvent4:"customEvent4",customEvent5:"customEvent5",customEvent6:"customEvent6",customEvent7:"customEvent7",customEvent8:"customEvent8",customEvent9:"customEvent9",customEvent10:"customEvent10"};q.prototype.setCustomVariableAlias=function(a,b){if(q.ALLOWED_VARIABLES.indexOf(a)>-1)this._variableAliases[b]=a;else throw Error("AnalyticsService.setCustomVariableAlias called with invalid realName: "+a);};q.prototype.setCustomEventAlias=function(a,b){if(q.ALLOWED_EVENTS.indexOf(a)>-1)this._eventAliases[b]=
a;else throw Error("AnalyticsService.setCustomEventAlias called with invalid realName:"+a);};q.prototype.trackPurchaseStart=function(a,b,c){c.entitlementCategory=a;c.productId=b;f.instance._send({action:"call",path:"analyticsService",data:{method:"trackPurchaseStart",event:{analyticsEvent:"kFolioPurchaseStartedAnalyticsEvent",analyticsEventName:"",variables:c}}})};q.prototype.trackPurchaseComplete=function(a,b,c,e,d){d.entitlementCategory=a;d.productId=b;d.purchasePrice=e;d.purchaseUnits=c;f.instance._send({action:"call",
path:"analyticsService",data:{method:"trackPurchaseComplete",event:{analyticsEvent:"kFolioPurchaseCompletedAnalyticsEvent",analyticsEventName:"",variables:d}}})};q.prototype.trackCustomEvent=function(a,b){if(q.ALLOWED_EVENTS.indexOf(this._eventAliases[a])!=-1)f.instance._send({action:"call",path:"analyticsService",data:{method:"trackCustomEvent",event:{analyticsEvent:this._eventAliases[a],analyticsEventName:a,variables:b}}});else throw Error("AnalyticsService.trackCustomEvent called with invalid eventName: "+
a);};q.instance=new q;m.extend(E);E.prototype.login=function(a,b,c){if(this.isUserAuthenticated)throw Error("Login failed. User is already authenticated.");else if(a=new Q(a,b,c)){h.instance._registerTransaction(a);d.instance.debug("Starting new UserSigninTransaction");try{return a.start()}catch(e){throw delete h.instance._allTransactions[a.id],e;}}else throw Error("There was a problem creating the UserSigninTransaction.");};E.prototype.logout=function(){if(this.isUserAuthenticated){var a=new ga;
if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new UserSignoutTransaction");try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the UserSignoutTransaction.");}else throw Error("Logout failed. User is not authenticated.");};E.prototype._update=function(a){d.instance.debug("AuthenticationService.prototype._update called:"+JSON.stringify(a));if(a.hasOwnProperty("update")){var b,c,a=a.update;b=[];if(a.hasOwnProperty("currentTransaction")&&
(c=h.instance._allTransactions[a.currentTransaction],this.currentTransaction!=c))this.currentTransaction=c,b.push("currentTransaction");if(a.hasOwnProperty("userName")&&this.userName!=a.userName)this.userName=a.userName,b.push("userName");if(a.hasOwnProperty("token")&&(d.instance.debug("old:"+this.token+" new:"+a.token),this.token!=a.token))this.token=a.token,b.push("token");if(a.hasOwnProperty("isUserAuthenticated")&&this.isUserAuthenticated!=a.isUserAuthenticated)this.isUserAuthenticated=a.isUserAuthenticated,
this.userAuthenticationChangedSignal.dispatch(this.isUserAuthenticated),b.push("isUserAuthenticated");b.length>0&&this.updatedSignal.dispatch(b)}else d.instance.warn("AuthenticationService._update called without update")};E.prototype.displaySignIn=function(){d.instance.debug("AuthenticationService.prototype.displaySignIn called.");f.instance._send({action:"call",path:"authenticationService",data:{method:"displaySignIn"}})};E.prototype._initialize=function(a){this._update(a)};E.instance=new E;m.extend(F);
var r=Math.floor(Math.random()*2E9);F.prototype._initialize=function(a){var b;if(a.hasOwnProperty("update")){var c=a.update;if(c.hasOwnProperty("applicationID"))this.applicationID=c.applicationID;if(c.hasOwnProperty("applicationVersion"))this.applicationVersion=c.applicationVersion;if(c.hasOwnProperty("adobeApplicationVersion"))this.adobeApplicationVersion=c.adobeApplicationVersion;if(c.hasOwnProperty("applicationStates"))for(a=0;a<c.applicationStates.length;a++)if(b=c.applicationStates[a],b.hasOwnProperty("type")&&
b.type=="ApplicationState"&&(b=$._fromJSON(b),b.type==ma.NATIVE||b.type==ma.WEBVIEW))this.applicationStates[b.label]=b;if(c.hasOwnProperty("applicationContext"))this.applicationContext=c.applicationContext}else d.instance.warn("ConfigurationService._initialize called without update")};F.prototype._update=function(a){if(a.hasOwnProperty("update"))if(a.update.hasOwnProperty("callbackId")){var b=this.callbacks[a.update.callbackId];b.hasOwnProperty("nativeData")&&b.nativeData.method=="canOpenURL"&&(b.callbackFunction(b.nativeData.url,
a.update.urlCanBeOpened),delete this.callbacks[a.update.callbackId])}else this.applicationContext=a.update,this.applicationContextUpdatedSignal.dispatch();else d.instance.warn("ConfigurationService._update called without update")};F.prototype.gotoState=function(a){if(this.applicationStates.hasOwnProperty(a))f.instance._send({action:"call",path:"configurationService",data:this.applicationStates[a]});else throw Error("ConfigurationService.gotoState called with invalid state label: "+a);};F.prototype.canOpenURL=
function(a,b){var c={method:"canOpenURL",url:a,callbackId:r};this.callbacks[r]={callbackFunction:b,nativeData:c};f.instance._send({action:"call",path:"configurationService",data:c});r++};F.instance=new F;m.extend(v);v.prototype._initialize=function(a){if(a.hasOwnProperty("update")){a=a.update;if(a.hasOwnProperty("isCustomDialogDisplaying"))this.isCustomDialogDisplaying=a.isCustomDialogDisplaying;if(a.hasOwnProperty("isWelcomeScreenDisplaying"))this.isWelcomeScreenDisplaying=a.isWelcomeScreenDisplaying;
if(a.hasOwnProperty("isCustomWebviewDisplaying"))this.isCustomWebviewDisplaying=a.isCustomWebviewDisplaying}else d.instance.warn("DialogService._initialize called without update")};v.prototype._update=function(a){if(a.hasOwnProperty("update")){var b=[],a=a.update;if(a.hasOwnProperty("isCustomDialogDisplaying")&&this.isCustomDialogDisplaying!=a.isCustomDialogDisplaying)this.isCustomDialogDisplaying=a.isCustomDialogDisplaying,b.push("isCustomDialogDisplaying");if(a.hasOwnProperty("isWelcomeScreenDisplaying")&&
this.isWelcomeScreenDisplaying!=a.isWelcomeScreenDisplaying)this.isWelcomeScreenDisplaying=a.isWelcomeScreenDisplaying,b.push("isWelcomeScreenDisplaying");this.updatedSignal.dispatch(b)}else d.instance.warn("DialogService._update called without update")};v.prototype.displayCustomDialog=function(){if(this.isCustomDialogDisplaying)throw Error("displayCustomDialog called while a dialog is displaying!");f.instance._send({action:"call",path:"dialogService",data:{method:"displayCustomDialog"}})};v.prototype.dismissCustomDialog=
function(){if(!this.isCustomDialogDisplaying)throw Error("dismissCustomDialog called but no dialog is displaying");f.instance._send({action:"call",path:"dialogService",data:{method:"dismissCustomDialog"}})};v.prototype.dismissWelcomeScreen=function(){if(!this.isWelcomeScreenDisplaying)throw Error("dismissWelcomeScreen called but no Welcome Screen is displaying");f.instance._send({action:"call",path:"dialogService",data:{method:"dismissWelcomeScreen"}})};v.prototype.displayCustomWebview=function(a){adobeDPS.log.info("DialogService.displayCustomWebview: "+
a);f.instance._send({action:"call",path:"dialogService",data:{method:"displayCustomWebview",url:a}})};v.prototype.dismissCustomWebview=function(){if(!this.isCustomWebviewDisplaying)throw Error("dismissCustomWebview called but no custom webview is displaying");f.instance._send({action:"call",path:"dialogService",data:{method:"dismissCustomWebview"}})};v.prototype.open=function(a){adobeDPS.log.info("DialogService.open "+a);a.toLowerCase().search(/^https{0,1}:\/\//)==-1?adobeDPS.log.error(Error("DialogService.open does not support relative URLs")):
f.instance._send({action:"call",path:"dialogService",data:{method:"open",url:a}})};v.prototype.close=function(){adobeDPS.log.info("DialogService.close");f.instance._send({action:"call",path:"dialogService",data:{method:"close"}})};v.prototype.openExternal=function(a){adobeDPS.log.info("DialogService.openExternal "+a);a.toLowerCase().search(/^https{0,1}:\/\//)==-1?adobeDPS.log.error(Error("DialogService.open does not support relative URLs")):f.instance._send({action:"call",path:"dialogService",data:{method:"openExternal",
url:a}})};v.instance=new v;var va={UNKNOWN:"unknown",WIFI:"wifi",MOBILE:"mobile"},r=Math.floor(Math.random()*2E9);m.extend(K);K.prototype._initialize=function(a){if(a.hasOwnProperty("update")){a=a.update;if(a.hasOwnProperty("deviceId"))this.deviceId=a.deviceId;if(a.hasOwnProperty("os"))this.os=a.os;if(a.hasOwnProperty("deviceName"))this.deviceName=a.deviceName;if(a.hasOwnProperty("isPurchasingEnabled"))this.isPurchasingEnabled=a.isPurchasingEnabled;if(a.hasOwnProperty("isOnline"))this.isOnline=a.isOnline;
if(a.hasOwnProperty("networkType"))this.networkType=a.networkType;if(a.hasOwnProperty("pushNotificationToken"))this.pushNotificationToken=a.pushNotificationToken;if(a.hasOwnProperty("omnitureVisitorId"))this.omnitureVisitorId=a.omnitureVisitorId;if(a.hasOwnProperty("identifierForVendor"))this.identifierForVendor=a.identifierForVendor;if(a.hasOwnProperty("advertisingIdentifier"))this.advertisingIdentifier=a.advertisingIdentifier;if(a.hasOwnProperty("isAdvertisingTrackingEnabled"))this.isAdvertisingTrackingEnabled=
a.isAdvertisingTrackingEnabled}else d.instance.warn("DeviceService._initialize called without update")};K.prototype._update=function(a){if(a.hasOwnProperty("update")){var b=[],a=a.update;if(a.hasOwnProperty("status")){d.instance.enableLogging=!0;var c=this.callbacks[a.callbackId];this.status=a.status;this.status!=1&&c.fail(a.errorCode,a.errorMessage);delete this.callbacks[a.callbackId]}if(a.hasOwnProperty("deviceId")&&this.deviceId!=a.deviceId)this.deviceId=a.deviceId,b.push("deviceId");if(a.hasOwnProperty("os")&&
this.os!=a.os)this.os=a.os,b.push("os");if(a.hasOwnProperty("deviceName")&&this.deviceName!=a.deviceName)this.deviceName=a.deviceName,b.push("deviceName");if(a.hasOwnProperty("isPurchasingEnabled")&&this.isPurchasingEnabled!=a.isPurchasingEnabled)this.isPurchasingEnabled=a.isPurchasingEnabled,b.push("isPurchasingEnabled");if(a.hasOwnProperty("isOnline")&&this.isOnline!=a.isOnline)this.isOnline=a.isOnline,b.push("isOnline");if(a.hasOwnProperty("networkType")&&this.networkType!=a.networkType)this.networkType=
a.networkType,b.push("networkType");if(a.hasOwnProperty("pushNotificationToken")&&this.pushNotificationToken!=a.pushNotificationToken)this.pushNotificationToken=a.pushNotificationToken,b.push("pushNotificationToken");if(a.hasOwnProperty("omnitureVisitorId")&&this.omnitureVisitorId!=a.omnitureVisitorId)this.omnitureVisitorId=a.omnitureVisitorId,b.push("omnitureVisitorId");if(a.hasOwnProperty("identifierForVendor")&&this.identifierForVendor!=a.identifierForVendor)this.identifierForVendor=a.identifierForVendor,
b.push("identifierForVendor");if(a.hasOwnProperty("advertisingIdentifier")&&this.advertisingIdentifier!=a.advertisingIdentifier)this.advertisingIdentifier=a.advertisingIdentifier,b.push("advertisingIdentifier");if(a.hasOwnProperty("isAdvertisingTrackingEnabled")&&this.isAdvertisingTrackingEnabled!=a.isAdvertisingTrackingEnabled)this.isAdvertisingTrackingEnabled=a.isAdvertisingTrackingEnabled,b.push("isAdvertisingTrackingEnabled");this.updatedSignal.dispatch(b)}else d.instance.warn("DeviceService._update called without update")};
K.prototype.enableAdvertisingFramework=function(a){this.callbacks[r]={fail:a};f.instance._send({action:"call",path:"deviceService",data:{method:"enableAdvertisingFramework",callbackId:r}});r++};K.instance=new K;m.extend(s);s.prototype.registerNewReceipt=function(a,b){var c;if(a instanceof Z){if((c=this.availableSubscriptions[a.productId])&&(c.receipt===null||c.receipt.endDate<a.endDate))c.receipt=a,c.isOwned=!0;c=a.productId+a.startDate.getTime().toString();this.subscriptionReceipts.hasOwnProperty(c)||
(this.subscriptionReceipts[c]=a,b||this.newReceiptsAvailableSignal.dispatch([a]))}else if(a instanceof R){if(c=u.instance.folioMap.getByProductId(a.productId))c.receipt=a;this.receipts.hasOwnProperty(a.productId)||(this.receipts[a.productId]=a,b||this.newReceiptsAvailableSignal.dispatch([a]))}else throw Error("ReceiptService.registerNewReceipt received invalid receipt");return a};s.prototype.restorePurchases=function(){var a=new fa;if(a){h.instance._registerTransaction(a);d.instance.debug("Starting new RestorePurchasesTransaction");
try{return a.start()}catch(b){throw delete h.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the RestorePurchasesTransaction.");};s.prototype.addSubscription=function(a){if(toString.call(a)=="[object String]"&&a!="")return this.addSubscriptions([a]);else throw Error("ReceiptService.addSubscription received invalid product ID");};s.prototype.addSubscriptions=function(a){var b,c,e;if(a instanceof Array){c=[];for(b=0;b<a.length;b++)if(e=a[b],toString.call(e)=="[object String]"&&
e!="")this.availableSubscriptions[e]==null&&c.push(new z(e,"","","",!1));else throw Error("ReceiptService.addSubscriptions received invalid product ID");if(c.length>0)return this._createModifySubscriptionsListTransaction(c,[]);else throw Error("Tried to add subscription(s) that already existed");}else throw Error("ReceiptService.addSubscriptions received invalid input");};s.prototype.removeSubscription=function(a){if(toString.call(a)=="[object String]"&&a!="")return this.removeSubscriptions([a]);
else throw Error("ReceiptService.removeSubscription received invalid product ID");};s.prototype.removeSubscriptions=function(a){var b,c,e;if(a instanceof Array){c=[];for(b=0;b<a.length;b++)if(e=a[b],toString.call(e)=="[object String]"&&e!="")e=this.availableSubscriptions[e],e!=null&&c.push(e.productId);else throw Error("ReceiptService.removeSubscriptions received invalid product ID");if(c.length>0)return this._createModifySubscriptionsListTransaction([],c);else throw Error("Tried to remove subscription(s) that did not exist");
}else throw Error("ReceiptService.removeSubscriptions received invalid input");};s.prototype.setSubscription=function(a){if(toString.call(a)=="[object String]"&&a!="")return this.setSubscriptions([a]);else throw Error("ReceiptService.setSubscription received invalid product ID");};s.prototype.setSubscriptions=function(a){var b,c,e,d;if(a instanceof Array){c=[];for(b=0;b<a.length;b++)if(e=a[b],toString.call(e)=="[object String]"&&e!="")d=this.availableSubscriptions[e],d==null&&c.push(new z(e,"","",
"",!1));else throw Error("ReceiptService.setSubscriptions received invalid product ID");b=[];for(e in this.availableSubscriptions)a.indexOf(e)==-1&&b.push(e);return this._createModifySubscriptionsListTransaction(c,b)}else throw Error("ReceiptService.setSubscriptions received invalid input");};s.prototype._createModifySubscriptionsListTransaction=function(a,b){var c=new X(a,b);if(c){h.instance._registerTransaction(c);d.instance.debug("Starting new ModifySubscriptionsListTransaction");d.instance.debug("ADDING:"+
JSON.stringify(a));d.instance.debug("REMOVING:"+JSON.stringify(b));try{return c.start()}catch(e){throw delete h.instance._allTransactions[c.id],e;}}else throw Error("There was a problem creating the ModifySubscriptionsListTransaction.");};s.prototype.displaySubscribe=function(){f.instance._send({action:"call",path:"receiptService",data:{method:"displaySubscribe"}})};s.prototype._initialize=function(a){var b,c,e,g;if(a.hasOwnProperty("update")){a=a.update;b=[];if(a.hasOwnProperty("activeSubscription"))g=
a.activeSubscription,g.type=="Subscription"?(delete g.type,this.activeSubscription=z._fromJSON(g)):this.activeSubscription=null;if(a.hasOwnProperty("receipts"))for(c in a.receipts)g=a.receipts[c],g=new R(g.broker,c,g.token),this.registerNewReceipt(g,!0),b.push(g);if(a.hasOwnProperty("availableSubscriptions"))for(c in a.availableSubscriptions)g=a.availableSubscriptions[c],this.availableSubscriptions[g.productId]=new z(c,g.title,g.duration,g.price,g.isOwned);if(a.hasOwnProperty("subscriptionReceipts"))for(e in a.subscriptionReceipts){g=
a.subscriptionReceipts[e];c=e.split("+");c=c.length>0?c[0]:e;g=new Z(g.broker,c,g.token,new Date(g.startDate),g.endDate===null?null:new Date(g.endDate));g.startDate.getTime();if((c=this.availableSubscriptions[g.productId])&&(c.receipt===null||c.receipt.endDate<g.endDate))c.receipt=g,c.isOwned=!0;this.registerNewReceipt(g,!0);b.push(g)}b.length>0&&(this.newReceiptsAvailableSignal.dispatch(b),d.instance.debug("ReceiptService._initialize added "+b.length+" receipts"))}else d.instance.warn("ReceiptService._initialize called without update")};
s.prototype._update=function(a){var b,c,e,g,f;d.instance.debug("ReceiptService._update called: "+JSON.stringify(a));if(a.hasOwnProperty("add")){b=a.add;c=[];e=[];for(g=0;g<b.length;g++)if(f=b[g],f.type=="Receipt")f=new R(f.broker,f.productId,f.token),this.registerNewReceipt(f,!0),c.push(f);else if(f.type=="SubscriptionReceipt"){f=new Z(f.broker,f.productId,f.token,new Date(f.startDate),f.endDate===null?null:new Date(f.endDate));f.startDate.getTime();if((a=this.availableSubscriptions[f.productId])&&
(a.receipt===null||a.receipt.endDate<f.endDate))a.receipt=f,a.isOwned=!0;d.instance.debug("\nReceiptService updated with Subscription Receipt: "+JSON.stringify(f));this.registerNewReceipt(f,!0);c.push(f)}else f.type=="Subscription"?(delete f.type,a=z._fromJSON(f),this.availableSubscriptions[f.productId]=a,e.push(a)):d.instance.warn("ReceiptService called with unknown add: "+f.type);c.length>0&&(this.newReceiptsAvailableSignal.dispatch(c),d.instance.debug("ReceiptService._update added "+c.length+" receipts"));
e.length>0&&(this.subscriptionsAddedSignal.dispatch(e),d.instance.debug("ReceiptService._update added "+e.length+" subscriptions"));c.length==0&&e.length==0&&d.instance.warn("ReceiptService._update called with an add that resulted in no new receipts or subscriptions")}else if(a.hasOwnProperty("remove")){c=a.remove;b=[];for(g=0;g<c.length;g++)a=this.availableSubscriptions[c[g]],a!==null?(delete this.availableSubscriptions[a.productId],b.push(a)):d.instance.warn("LibraryService._update failed to parse removed subscription: "+
c[g]);b.length>0?(this.subscriptionsRemovedSignal.dispatch(b),d.instance.debug("Removed "+b.length+" subscriptions")):d.instance.warn("LibraryService._update called with remove that didn't remove any subscriptions")}else if(a.hasOwnProperty("update"))if(b=a.update,a.path.indexOf("availableSubscriptions")>-1)g=a.path.indexOf("']"),g=a.path.substring(24,g),(a=this.availableSubscriptions[g])?a._updateFromJSON(b):d.instance.warn("ReceiptService._update called with unknown Sub: "+g);else{if(b.hasOwnProperty("activeSubscription"))f=
b.activeSubscription,f.type=="Subscription"?(delete f.type,this.activeSubscription=z._fromJSON(f)):this.activeSubscription=null,this.updatedSignal.dispatch(["activeSubscription"])}else d.instance.warn("ReceiptService._update called without add")};s.instance=new s;m.extend(N);N.prototype._initialize=function(a){var b;if(a.hasOwnProperty("update"))for(b in a=a.update,a)d.instance.debug("Found "+b+" setting."),this.hasOwnProperty(b)?this[b]._initialize(a[b]):d.instance.warn("SettingsService._initialize called with unknown setting: "+
b);else d.instance.warn("SettingsService._initialize called without update")};N.prototype._update=function(a){var b=this._getNextPathElement(a.path);a.path=this._getChildPath(a.path);switch(b){case "autoArchive":d.instance.debug("Initializing SettingsService.AutoArchive...");this.autoArchive._update(a);break;default:d.instance.warn("SettingsService._update called with an unknown destination: "+b)}};N.instance=new N;var Ba=function(a,b){this.coords=a;this.timestamp=b===void 0?new Date:b instanceof
Date?b:new Date(b)};W.PERMISSION_DENIED=1;W.POSITION_UNAVAILABLE=2;W.TIMEOUT=3;var oa=Math.pow(2,31)-1,r=Math.floor(Math.random()*2E9);m.extend(G);G.prototype._update=function(a){if(a.hasOwnProperty("update"))if(a=a.update,a.hasOwnProperty("status")){var b=this.callbacks[a.callbackId];clearTimeout(b.timeout.timer);if(a.status===1){if(b.timeout.timer){var c=new wa(a.latitude,a.longitude,a.altitude,a.accuracy,a.course,a.speed,a.altitudeAccuracy);this.lastPosition=c=new Ba(c,a.timestamp);b.success(c)}}else b.timeout.timer=
null,b.fail&&(c=new W(a.errorCode,a.errorMessage),b.fail(c));delete this.callbacks[a.callbackId]}else d.instance.warn("GeolocationService._update called without status");else d.instance.warn("GeolocationService._update called without update")};G.prototype.getCurrentPosition=function(a,b,c){if(a===void 0||a===null)throw Error("Invalid success callback function!");var d=new xa;if(c){if(c.maximumAge!==void 0&&!isNaN(c.maximumAge)&&c.maximumAge>=0)d.maximumAge=c.maximumAge>=oa?oa:c.maximumAge;if(c.enableHighAccuracy!==
void 0)d.enableHighAccuracy=c.enableHighAccuracy;if(c.timeout!==void 0&&!isNaN(c.timeout))d.timeout=c.timeout<0?0:c.timeout>=oa?-1:c.timeout}c=d;d={timer:null};this.lastPosition&&c.maximumAge&&(new Date).getTime()-this.lastPosition.timestamp.getTime()<=c.maximumAge?a(this.lastPosition):c.timeout===0?b({code:W.TIMEOUT,message:"timeout value in PositionOptions set to 0 and no cached Position object available, or cached Position object's age exceeds provided PositionOptions' maximumAge parameter."}):
(d.timer=c.timeout!==-1?ya(r,c.timeout):!0,this.callbacks[r]={success:a,fail:b,timeout:d},f.instance._send({action:"call",path:"geolocationService",data:{method:"getCurrentPosition",callbackId:r,highAccuracy:c&&c.enableHighAccuracy!==void 0?c.enableHighAccuracy:!1,maximumAge:c.maximumAge,timeout:c.timeout}}),r++)};G.prototype.watchPosition=function(){throw Error("geolocation.watchPosition API is currently not supported!");};G.prototype.clearWatch=function(){throw Error("geolocation.clearWatch API is currently not supported!");
};G.instance=new G;m.extend(t);var r=Math.floor(Math.random()*2E9),ua=Math.floor(Math.random()*2E9);t.prototype._initialize=function(){};t.prototype.EventItem=function(a,b,c,d){this.summary=a;this.description=b||void 0;this.location=c||void 0;this.alarms=d||void 0};t.prototype.CalendarEvent=function(a,b,c,d,f){this.eventItem=new t.instance.EventItem(a.summary,a.description,a.location,a.alarms);this.startDate=b;this.endDate=c;this.allDay=d||!1;this.eventId=f||ua++};t.prototype.ReminderEvent=function(a,
b,c,d){this.eventItem=new t.instance.EventItem(a.summary,a.description,a.location,a.alarms);this.listTitle=b||void 0;this.dueDate=c||void 0;this.eventId=d||ua++};t.prototype.EventResult=function(a,b,c,d,f){this.success=a;this.eventType=b;this.eventId=c;this.errorCode=d;this.errorMessage=f};t.prototype._update=function(a){if(a.hasOwnProperty("update"))if(a.update.hasOwnProperty("callbackId")){var b=0,c=this.callbacks[a.update.callbackId];if(c.hasOwnProperty("method")){var e=null,f;c.method=="addEvents"?
(e=a.update.results,f=!1):c.method=="addEvent"&&(e=[a.update.results],f=!0);if(e){var b=e.length,h,i=[],j=[],k=0,l=0;for(h=0;h<b;h++){var m=e[h];m.success?i[k++]=m:j[l++]=m}k>0&&(f?c.successCallback(i[0]):c.successCallback(i));l>0&&(f?c.errorCallback(j[0]):c.errorCallback(j))}}c.eventCount-=b;c.eventCount==0&&delete this.callbacks[a.update.callbackId]}else d.instance.warn("CalendarService._update called without callbackId");else d.instance.warn("CalendarService._update called without update")};t.prototype.ErrorType=
{Unknown:0,AccessToCalendarRestricted:1,AccessToRemindersRestricted:2,AccessToCalendarDenied:3,AccessToRemindersDenied:4};t.prototype.addEvent=function(a,b,c){a={method:"addEvent",event:a,callbackId:r};this.callbacks[r]={method:a.method,eventCount:1,successCallback:b||function(){},errorCallback:c||function(){}};f.instance._send({action:"call",path:"calendarService",data:a});r++};t.prototype.addEvents=function(a,b,c){var d={method:"addEvents",events:a,callbackId:r};this.callbacks[r]={method:d.method,
eventCount:a.length,successCallback:b||function(){},errorCallback:c||function(){}};f.instance._send({action:"call",path:"calendarService",data:d});r++};t.instance=new t;var Aa={RECORDING_STARTED:1,RECORDING_STOPPED:2,RECORDING_STOPPED_BY_ERROR:3,RECORDING_STOPPED_BY_APP_SHUTDOWN:4},I={STORAGE_OUT_OF_SPACE:1,STORAGE_IO_ERROR:2,RECORDING_ALREADY_STARTED:11,RECORDING_NOT_STARTED:12,RECORDING_INVALID_ID:13,RECORDING_INVALID_ARGUMENT:14};m.extend(B);B.prototype._initialize=function(a){if(a.hasOwnProperty("update")){a=
a.update;if(a.hasOwnProperty("supportedEventNames"))this.supportedEventNames=a.supportedEventNames;if(a.hasOwnProperty("supportedEventAttributes"))this.supportedEventAttributes=a.supportedEventAttributes;if(a.hasOwnProperty("recordings"))this.recordings=a.recordings;if(a.hasOwnProperty("currentRecordingId"))this.currentRecordingId=a.currentRecordingId}else d.instance.warn("DialogService._initialize called without update")};B.prototype._update=function(a){if(a.hasOwnProperty("update")){if(a=a.update,
a.hasOwnProperty("status")){var b=this.callbacks[a.callbackId];delete this.callbacks[a.callbackId];if(a.currentRecordingId!==void 0&&this.currentRecordingId!==a.currentRecordingId||a.recordings!==void 0&&this.recordings!==a.recordings)this.recordings=a.recordings,this.currentRecordingId=a.currentRecordingId,this.stateChangedSignal.dispatch();if(a.status===1)if(H(b))switch(b.type){case "getEvents":b=b.successCB;a={recordingId:a.recordingId,events:a.events};n(b)&&b(a);break;case "deleteEvents":b=b.successCB;
a=a.recordingId;n(b)&&b(a);break;default:b.successCB()}else{if(H(a.eventsCount))for(b=0;b<this.recordings.length;++b)if(this.recordings[b].recordingId==a.recordingId){this.recordings[b].eventsCount=a.eventsCount;this.stateChangedSignal.dispatch();break}}else if(H(b))a.storageSize===void 0?(b=b.errorCB,a={recordingId:a.recordingId,error:{code:a.errorCode,message:a.errorMessage}}):(b=b.errorCB,a={recordingId:a.recordingId,error:{code:a.errorCode,message:a.errorMessage,storageSize:a.storageSize}}),n(b)&&
b(a)}}else d.instance.warn("FolioActivityService._update called without update data")};B.prototype.startRecording=function(a,b,c,d){ba(d,"Undefined error callback function");za(b,this.supportedEventNames)?na(a)?!n(c)&&H(c)?(b={code:I.RECORDING_INVALID_ARGUMENT,message:"Invalid success callback"},d({recordingId:a,error:b})):(this.callbacks[this.callbackId]={type:"startRecording",successCB:c,errorCB:d},f.instance._send({action:"call",path:"folioActivityService",data:{method:"startRecording",callbackId:this.callbackId,
recordingId:a,config:b}}),this.callbackId++):(b={code:I.RECORDING_INVALID_ID,message:"Invalid recordingId"},d({recordingId:a,error:b})):(b={code:I.RECORDING_INVALID_ARGUMENT,message:"Invalid config"},d({recordingId:a,error:b}))};B.prototype.stopRecording=function(a,b){ba(b,"Undefined error callback function");!n(a)&&H(a)?b({recordingId:void 0,error:{code:I.RECORDING_INVALID_ARGUMENT,message:"Invalid success callback"}}):(this.callbacks[this.callbackId]={type:"stopRecording",successCB:a,errorCB:b},
f.instance._send({action:"call",path:"folioActivityService",data:{method:"stopRecording",callbackId:this.callbackId}}),this.callbackId++)};B.prototype.getEvents=function(a,b,c){ba(c,"Undefined error callback function");na(a)?n(b)?(this.callbacks[this.callbackId]={type:"getEvents",successCB:b,errorCB:c},f.instance._send({action:"call",path:"folioActivityService",data:{method:"getEvents",callbackId:this.callbackId,recordingId:a}}),this.callbackId++):(b={code:I.RECORDING_INVALID_ARGUMENT,message:"Invalid success callback function"},
c({recordingId:a,error:b})):(b={code:I.RECORDING_INVALID_ID,message:"Invalid recordingId"},c({recordingId:a,error:b}))};B.prototype.deleteEvents=function(a,b,c){ba(c,"Undefined error callback function");!na(a)&&H(a)&&!(typeof a==="string"&&a.length===0)?(b={code:I.RECORDING_INVALID_ID,message:"Invalid recordingId"},c({recordingId:a,error:b})):!n(b)&&H(b)?(b={code:I.RECORDING_INVALID_ARGUMENT,message:"Invalid success callback"},c({recordingId:a,error:b})):(this.callbacks[this.callbackId]={type:"deleteEvents",
successCB:b,errorCB:c},f.instance._send({action:"call",path:"folioActivityService",data:{method:"deleteEvents",callbackId:this.callbackId,recordingId:a}}),this.callbackId++)};B.prototype.resetService=function(a,b){ba(b,"Undefined error callback function");!n(a)&&H(a)?b({recordingId:void 0,error:{code:I.RECORDING_INVALID_ARGUMENT,message:"Invalid success callback"}}):(this.callbacks[this.callbackId]={type:"resetService",successCB:a,errorCB:b},f.instance._send({action:"call",path:"folioActivityService",
data:{method:"resetService",callbackId:this.callbackId}}),this.callbackId++)};B.instance=new B;var p={OPERATION_IN_PROGRESS:1,INVALID_AUTH_SESSION:2,INVALID_ARGUMENTS:3};m.extend(C);C.prototype._update=function(a){if(a.hasOwnProperty("update")){if(a=a.update,a.hasOwnProperty("status"))if(a.status===1){if(o(a.callbackId)){var b=this.callback;this.callback=null;if(a.hasOwnProperty("oauthData")&&(this.oauthData=a.oauthData,this.oauthData==""))this.oauthData=null;b.successCB()}}else if(a.status===0){if(o(a.callbackId))b=
this.callback,this.callback=null,b.errorCB({code:a.errorCode,message:a.errorMessage})}else if(a.status===2)clearTimeout(this.timer),this.oauthData=a.oauthData,a=this.responseHandler,this.responseHandler=null,a(this.oauthData);else if(a.status===3)clearTimeout(this.timer),a=this.responseHandler,this.responseHandler=null,a({timeout:"Server timed out!"})}else d.instance.warn("OAuthRedirectService._update called without update data")};C.prototype.initAuthData=function(a,b,c){if(!n(c))throw Error("Invalid error handler!");
!o(a)||typeof a!=="object"?c({code:p.INVALID_ARGUMENTS,message:"The authSettings is invalid."}):!o(a.authURL)||typeof a.authURL!=="string"||a.authURL==""?c({code:p.INVALID_ARGUMENTS,message:"The authURL is invalid."}):!o(a.clientId)||typeof a.clientId!=="string"||a.clientId==""?c({code:p.INVALID_ARGUMENTS,message:"The clientId is invalid."}):!o(a.redirectURI)||typeof a.redirectURI!=="string"||a.redirectURI==""?c({code:p.INVALID_ARGUMENTS,message:"The redirectURI is invalid."}):n(b)?o(this.callback)||
o(this.responseHandler)?c({code:p.OPERATION_IN_PROGRESS,message:"An operation is already in progress."}):(this.clientId=a.clientId,this.redirectURI=a.redirectURI,this.oauthData=null,this.callback={successCB:b,errorCB:c},f.instance._send({action:"call",path:"oauthRedirectService",data:{method:"init",callbackId:this.callbackId,authURL:a.authURL,clientId:a.clientId,redirectURI:a.redirectURI}}),this.callbackId++):c({code:p.INVALID_ARGUMENTS,message:"The success callback is invalid."})};C.prototype.startListening=
function(a,b,c){if(!n(c))throw Error("Invalid error handler!");n(b)?n(a)?!o(this.clientId)||typeof this.clientId!=="string"||this.clientId==""?c({code:p.INVALID_AUTH_SESSION,message:"The authorization session is invalid. initAuthData() must be called first."}):o(this.callback)||o(this.responseHandler)?c({code:p.OPERATION_IN_PROGRESS,message:"An operation is already in progress."}):(this.callback={successCB:b,errorCB:c},this.responseHandler=a,this.timer=setTimeout(function(){this.responseHandler=null},
this.timeout),f.instance._send({action:"call",path:"oauthRedirectService",data:{method:"startListening",clientId:this.clientId,callbackId:this.callbackId,timeout:this.timeout}}),this.callbackId++):c({code:p.INVALID_ARGUMENTS,message:"The response callback is invalid."}):c({code:p.INVALID_ARGUMENTS,message:"The success callback is invalid."})};C.prototype.stopListening=function(a,b){if(!n(b))throw Error("Invalid error handler!");n(a)?!o(this.clientId)||typeof this.clientId!=="string"||this.clientId==
""?b({code:p.INVALID_AUTH_SESSION,message:"The authorization session is invalid. initAuthData() must be called first."}):o(this.callback)?b({code:p.OPERATION_IN_PROGRESS,message:"An operation is already in progress."}):(clearTimeout(this.timer),this.responseHandler=null,this.callback={successCB:a,errorCB:b},f.instance._send({action:"call",path:"oauthRedirectService",data:{method:"stopListening",clientId:this.clientId,callbackId:this.callbackId}}),this.callbackId++):b({code:p.INVALID_ARGUMENTS,message:"The success callback is invalid."})};
C.prototype.updateAuthData=function(a,b,c){if(!n(c))throw Error("Invalid error handler!");n(b)?!o(a)||typeof a!=="object"?c({code:p.INVALID_ARGUMENTS,message:"The authData is invalid."}):!o(this.clientId)||typeof this.clientId!=="string"||this.clientId==""?c({code:p.INVALID_AUTH_SESSION,message:"The authorization session is invalid. initAuthData() must be called first."}):o(this.callback)||o(this.responseHandler)?c({code:p.OPERATION_IN_PROGRESS,message:"An operation is already in progress."}):(this.callback=
{successCB:b,errorCB:c},f.instance._send({action:"call",path:"oauthRedirectService",data:{method:"update",clientId:this.clientId,callbackId:this.callbackId,data:a}}),this.callbackId++):c({code:p.INVALID_ARGUMENTS,message:"The success callback is invalid."})};C.prototype.resetAuthData=function(a,b){if(!n(b))throw Error("Invalid error handler!");n(a)?!o(this.clientId)||typeof this.clientId!=="string"||this.clientId==""?b({code:p.INVALID_AUTH_SESSION,message:"The authorization session is invalid. initAuthData() must be called first."}):
o(this.callback)||o(this.responseHandler)?b({code:p.OPERATION_IN_PROGRESS,message:"An operation is already in progress."}):(this.callback={successCB:a,errorCB:b},f.instance._send({action:"call",path:"oauthRedirectService",data:{method:"reset",clientId:this.clientId,callbackId:this.callbackId}}),this.callbackId++):b({code:p.INVALID_ARGUMENTS,message:"The success callback is invalid."})};C.instance=new C;m.extend(f);f.prototype._generateUID=function(){return Math.floor(Math.random()*1E4).toString()+
(new Date).getTime().toString()};f.prototype._initialize=function(a){var b,c,e;try{d.instance.debug("Interface._initialize called");(!a.hasOwnProperty("length")||a.length<=0)&&d.instance.warn("Interface._initialize called with no data");for(b=0;b<a.length;b++)if(c=a[b],c.hasOwnProperty("path"))switch(e=this._getNextPathElement(c.path),c.path=this._getChildPath(c.path),e){case "libraryService":d.instance.debug("Initializing libraryService...");u.instance._initialize(c);break;case "transactionManager":d.instance.debug("Initializing transactionManager...");
h.instance._initialize(c);break;case "authenticationService":d.instance.debug("Initializing authenticationService...");E.instance._initialize(c);break;case "configurationService":d.instance.debug("Initializing configurationService...");F.instance._initialize(c);break;case "deviceService":d.instance.debug("Initializing deviceService...");K.instance._initialize(c);break;case "receiptService":d.instance.debug("Initializing receiptService...");s.instance._initialize(c);break;case "settingsService":d.instance.debug("Initializing settingsService...");
N.instance._initialize(c);break;case "analyticsService":d.instance.debug("Initializing analyticsService...");q.instance._initialize(c);break;case "dialogService":d.instance.debug("Initializing dialogService...");v.instance._initialize(c);break;case "geolocationService":d.instance.debug("Initializing geolocationService...");this.geolocation=G.instance;G.instance._initialize(c);break;case "calendarService":d.instance.debug("Initializing calendarService...");t.instance._initialize(c);break;case "oauthRedirectService":d.instance.debug("Initializing oauthRedirectService...");
this.oauthRedirectService=C.instance;C.instance._initialize(c);break;case "folioActivityService":d.instance.debug("Initializing folioActivityService...");this.folioActivityService=B.instance;B.instance._initialize(c);break;default:d.instance.warn("Interface._initialize called with an unknown destination: "+e)}else d.instance.warn("Interface._initialize received update without path: "+JSON.stringify(c));d.instance.profile("InitializationTime");this.initializationComplete.dispatch();d.instance.info("Initialization complete")}catch(f){d.instance.error(f)}};
f.prototype._update=function(a){var b,c,e;try{for(b=0;b<a.length;b++)if(c=a[b],c.hasOwnProperty("path"))switch(e=this._getNextPathElement(c.path),c.path=this._getChildPath(c.path),e){case "libraryService":u.instance._update(c);break;case "transactionManager":h.instance._update(c);break;case "authenticationService":E.instance._update(c);break;case "configurationService":F.instance._update(c);break;case "deviceService":K.instance._update(c);break;case "receiptService":s.instance._update(c);break;case "settingsService":N.instance._update(c);
break;case "analyticsService":q.instance._update(c);break;case "dialogService":v.instance._update(c);break;case "geolocationService":G.instance._update(c);break;case "calendarService":t.instance._update(c);break;case "oauthRedirectService":C.instance._update(c);break;case "folioActivityService":B.instance._update(c);break;default:d.instance.warn("Interface._update called with an unknown destination: "+e)}else d.instance.warn("Interface._update received update without path: "+JSON.stringify(c))}catch(f){d.instance.error(f)}};
f.prototype._send=function(a){try{this._bridge.out({event:{type:"LibraryAPIActions",actions:[a]}})}catch(b){d.instance.error(b)}};f.instance=new f;return f.instance}();